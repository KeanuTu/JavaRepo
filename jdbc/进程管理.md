# 进程管理

**Q1:**  进程的状态有哪些？

A：

> 进程的5状态模型：
>
> **运行态**：已经获得CPU，该进程正在执行。
>
>  		注：在单处理机系统只有一个进程处于执行状态。多处理机则有多个处理执行状态 
>
> **就绪态**：进程已经做好了准备（ 除处理机以外的所有必要资源 ），只要有机会（获得处理机）就开始执行。
>
> **阻塞态**（等待态）：进程在某些事情发生前不能执行，等待阻塞进程的事件完成。
>
> ​		 注：引起阻塞的事件：请求I/O，申请缓存 
>
> **新建态**：刚刚创建的进程，操作系统还没有把它加入到可执行进程组中，通常是进程控制块已经创建但是还没有加载到内存中的进程。
>
> **退出态**：操作系统从可执行进程组中释放出的进程，或由于自身或某种原因停止运行。

![状态转换图](C:\Users\Administrator\Desktop\状态转换图.png)



**Q2:**  进程之间是怎么切换的？

A：` 操作系统为了控制进程的执行，必须有能力挂起正在CPU上运行的进程，并恢复以前挂起的某个进程的执行，这种行为被称为进程切换，任务切换或上下文切换。 `

**空->新建**：创建执行一个程序的新进程，可能的事件有：新的批处理作业、交互登录（终端用户登录到系统）、操作系统因为提供一项服务而创建、由现有的进程派生等。

**新建->就绪**：操作系统准备好再接纳一个进程时，把一个进程从新建态转换为就绪态。

**就绪->运行**：需要选择一个新进程运行时，操作系统的调度器或分配器根据某种调度算法选择一个处于就绪态的进程。

**运行->退出**：导致进程终止的原因有：正常完成、超过时限、系统无法满足进程需要的内存空间、进程试图访问不允许访问的内存单元（越界）、算术错误（如除以0或存储大于硬件可以接纳的数字）、父进程终止（操作系统可能会自动终止该进程所有的后代进程）、父进程请求终止后代进程等。

**运行->就绪**：最常见的原因是，正在运行的进程到达了“允许不中断执行”的最大时间段，该把处理器的资源释放给其他在就绪态的进程使用了；还有一中原因可能是由于具有更改优先级的就绪态进程抢占了该进程的资源，使其被中断转换到就绪态。

**运行->阻塞**：如果进程请求它必须等待的某些事件，例如一个无法立即得到的资源（如I/O操作），只有在获得等待的资源后才能继续进程的执行，则进入等待态（阻塞态）。

**阻塞->就绪**：当等待的事件发生时，处于阻塞态的进程转换到就绪态。

**就绪->退出**：在上图中没有标出这种转换，在某些进程中，父进程可以在任何时刻终止一个子进程，如果一个父进程终止，所有相关的子进程都被终止。

**阻塞->退出**：跟上一项原因类似。



**Q3：**线程的状态有哪些，以及如何相互切换的？

A：

> 线程共包括以下 5 种状态:
>
> **1. 新建状态(New):** 线程对象被创建后，就进入了新建状态。例如，Thread thread = new Thread()。
>
> **2. 就绪状态(Runnable):** 也被称为“可执行状态”。线程对象被创建后，其它线程调用了该对象的start()方法，从而来启动该线程。例如，thread.start()。处于就绪状态的线程，随时可能被CPU调度执行。
>
> **3. 运行状态(Running):** 线程获取CPU权限进行执行。需要注意的是，线程只能从就绪状态进入到运行状态。
>
> **4. 阻塞状态(Blocked):** 阻塞状态是线程因为某种原因放弃CPU使用权，暂时停止运行。直到线程进入就绪状态，才有机会转到运行状态。阻塞的情况分三种：
>
> - (01) 等待阻塞 -- 通过调用线程的wait()方法，让线程等待某工作的完成。
> - (02) 同步阻塞 -- 线程在获取synchronized同步锁失败(因为锁被其它线程所占用)，它会进入同步阻塞状态。
> - (03) 其他阻塞 -- 通过调用线程的sleep()或join()或发出了I/O请求时，线程会进入到阻塞状态。当sleep()状态超时、join()等待线程终止或者超时、或者I/O处理完毕时，线程重新转入就绪状态。
>
> **5. 死亡状态(Dead):** 线程执行完了或者因异常退出了run()方法，该线程结束生命周期。

![线程状态图](https://www.runoob.com/wp-content/uploads/2014/09/716271-20170320112245721-1831918220.jpg)





**Q4：**线程和进程的区别？

A：

*1、进程是资源分配的最小单位，线程是程序执行的最小单位（资源调度的最小单位）*
*2、进程有自己的独立地址空间，每启动一个进程，系统就会为它分配地址空间，建立数据表来维护代码段、堆栈段和数据段，这种操作非常昂贵。*
*而线程是共享进程中的数据的，使用相同的地址空间，因此CPU切换一个线程的花费远比进程要小很多，同时创建一个线程的开销也比进程要小很多。*
*3、线程之间的通信更方便，同一进程下的线程共享全局变量、静态变量等数据，而进程之间的通信需要以通信的方式（IPC)进行。不过如何处理好同步与互斥是编写多线程程序的难点。*
4、但是多进程程序更健壮，多线程程序只要有一个线程死掉，整个进程也死掉了，而一个进程死掉并不会对另外一个进程造成影响，因为进程有自己独立的地址空间。



